<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>MAP DEV TOOL PRO</title>

<style>

body{
  margin:0;
  background:#111;
  font-family:Arial;
  color:white;
}

.wrapper{
  max-width:1400px;
  margin:auto;
  position:relative;
}

.map{
  width:100%;
  display:block;
  border-radius:12px;
}

.marker{
  position:absolute;
  width:160px;
  height:36px;
  transform:translate(-50%,-50%);
  border-radius:8px;
  pointer-events:none;
}

.blue{ border:2px solid #00eaff; }
.purple{ border:2px solid #c16bff; }
.red{ border:2px solid #ff4d4d; }
.yellow{ border:2px solid #ffd84d; }

.panel{
  position:fixed;
  right:20px;
  top:20px;
  background:#000c;
  padding:14px;
  font-size:13px;
  max-width:340px;
  border-radius:8px;
}

button{
  margin:3px;
  padding:6px 10px;
  border:none;
  border-radius:6px;
  cursor:pointer;
}

.active{
  outline:2px solid white;
}

textarea{
  width:100%;
  height:220px;
  background:#111;
  color:#0f0;
  margin-top:8px;
}

</style>
</head>

<body>

<div class="wrapper" id="wrapper">
  <img src="/ER-calc/map/gvg-map.png" id="map" class="map">
</div>

<div class="panel">

  <div>
    COLOR:
    <button id="blueBtn">Blue</button>
    <button id="purpleBtn">Purple</button>
    <button id="redBtn">Red</button>
    <button id="yellowBtn">Yellow</button>
  </div>

  <hr>

  <button id="undoBtn">UNDO</button>
  <button id="clearBtn">CLEAR ALL</button>

  <textarea id="output"></textarea>

</div>

<script>

const map = document.getElementById("map");
const wrapper = document.getElementById("wrapper");
const output = document.getElementById("output");

const blueBtn = document.getElementById("blueBtn");
const purpleBtn = document.getElementById("purpleBtn");
const redBtn = document.getElementById("redBtn");
const yellowBtn = document.getElementById("yellowBtn");

const undoBtn = document.getElementById("undoBtn");
const clearBtn = document.getElementById("clearBtn");

let currentColor = "blue";
let markers = [];
let data = [];

function setActive(btn){
  [blueBtn,purpleBtn,redBtn,yellowBtn].forEach(b=>b.classList.remove("active"));
  btn.classList.add("active");
}

blueBtn.onclick=()=>{currentColor="blue";setActive(blueBtn);}
purpleBtn.onclick=()=>{currentColor="purple";setActive(purpleBtn);}
redBtn.onclick=()=>{currentColor="red";setActive(redBtn);}
yellowBtn.onclick=()=>{currentColor="yellow";setActive(yellowBtn);}

setActive(blueBtn);

map.addEventListener("click", e => {

  const rect = map.getBoundingClientRect();

  const x = ((e.clientX - rect.left) / rect.width) * 100;
  const y = ((e.clientY - rect.top) / rect.height) * 100;

  createMarker(x,y,currentColor);

});

function createMarker(x,y,type){

  const box = document.createElement("div");
  box.className = "marker " + type;
  box.style.left = x+"%";
  box.style.top = y+"%";

  wrapper.appendChild(box);

  markers.push(box);

  data.push({
    x:Number(x.toFixed(2)),
    y:Number(y.toFixed(2)),
    type:type
  });

  renderOutput();
}

undoBtn.onclick=()=>{
  if(markers.length===0) return;

  const last = markers.pop();
  last.remove();
  data.pop();
  renderOutput();
};

clearBtn.onclick=()=>{
  markers.forEach(m=>m.remove());
  markers=[];
  data=[];
  renderOutput();
};

function renderOutput(){

  let txt = "SKOPIUJ DO map.js:\n\n";

  data.forEach(p=>{
    txt += `{ x:${p.x}, y:${p.y}, type:"${p.type}" },\n`;
  });

  output.value = txt;
}

</script>

</body>
</html>
